<?xml version="1.0"?>
<launch>

  <!-- load world -->
  <include file="$(find katana_arm_gazebo)/launch/grasp_world.launch" />

  <!-- load katana urdf -->
  <include file="$(find katana_description)/launch/upload_katana.launch" />

  <!-- push robot_description to factory and spawn robot in gazebo -->
  <!-- <node name="spawn_katana_model" pkg="gazebo" type="spawn_model" args="$(optenv ROBOT_INITIAL_POSE) -z 0.01 -unpause -urdf -param robot_description -model katana" respawn="false" output="screen"/> -->
  <node name="spawn_katana_model" pkg="gazebo" type="spawn_model" args="$(optenv ROBOT_INITIAL_POSE) -z 0.01 -urdf -param robot_description -model katana" respawn="false" output="screen"/>

  <!-- Default Controllers -->
  <!-- TODO: find out correct PID parameters: -->
  <rosparam command="load" file="$(find katana_arm_gazebo)/config/katana_arm_controller.yaml" />
  <!-- TODO:
  <rosparam command="load" file="$(find katana_arm_gazebo)/config/katana_gripper_controller.yaml" />
  -->

  <!-- Controller manager parameters -->
  <param name="pr2_controller_manager/mechanism_statistics_publish_rate" value="1.0" />
  <param name="pr2_controller_manager/joint_state_publish_rate" value="100.0" />

  <!-- Robot state publisher -->
  <node pkg="robot_state_publisher" type="state_publisher" name="robot_state_publisher">
    <param name="publish_frequency" type="double" value="50.0" />
    <param name="tf_prefix" type="string" value="" />
  </node>

  <!-- Controllers that come up loaded -->
  <node name="default_loaded_controllers_spawner"
    pkg="pr2_controller_manager" type="spawner" output="screen"
    args="--wait-for=/calibrated katana_arm_controller" />  <!-- TODO: add katana_gripper_controller-->

  <!-- Fake calibration -->
  <node pkg="rostopic" type="rostopic" name="fake_joint_calibration"
    args="pub /calibrated std_msgs/Bool true" />

  <!-- TODO: Gripper action -->
  <!--
  <group ns="r_gripper_controller">
    <node name="gripper_action_node"
      pkg="pr2_gripper_action" type="pr2_gripper_action" />
  </group>
  -->

  <!--
  <include file="$(find katana_arm_gazebo)/launch/cylinder_object.launch"/>
  -->
  <include file="$(find katana_arm_gazebo)/launch/coke_can.launch"/>
</launch>

